select 
	q.query_name,
	Round(sum(q.rating * 1.0 / q.position) / count(q.query_name), 2) as quality,
	Round(sum(case when q.rating < 3 then 1 else 0 end) * 1.0 / count(q.query_name) * 100, 2) as poor_query_percentage
from Queries q
group by query_name
