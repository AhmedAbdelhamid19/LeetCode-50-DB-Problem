with singleDep as (
	select employee_id
	from Employee
	group by employee_id
	having count(employee_id) = 1
)
select employee_id, department_id
from Employee
where primary_flag = 'Y'
UNION
select e.employee_id, e.department_id
from Employee e inner join singleDep s on e.employee_id = s.employee_id
